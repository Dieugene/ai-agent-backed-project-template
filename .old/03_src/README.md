# 03_src — Исходный код

## Назначение
Рабочий код проекта — CLI, библиотеки, скрипты, конфигурации.

## Ответственный
**Разработчик**

## Структура

```
03_src/
├── 001_cli/                    # CLI интерфейс
│   ├── main.py
│   └── README.md
├── 002_core_module/            # Основной модуль
│   ├── processor.py
│   └── README.md
├── 003_data_processing/        # Обработка данных
│   ├── loader.py
│   ├── transformer.py
│   └── README.md
└── README.md
```

## Правила именования модулей

### Формат
- **Папка:** `NNN_module_name/`
- **Нумерация:** трехзначная, последовательная (001, 002, 003, ...)
- **Название:** краткое отражение назначения модуля
- **Стиль:** латиница, snake_case, без пробелов

### Примеры
- `001_cli/` — точка входа, CLI команды
- `002_core/` — основная бизнес-логика
- `003_api_client/` — клиент внешнего API
- `004_data_processing/` — обработка данных
- `005_utils/` — вспомогательные утилиты

## Что хранится

### Код
- Python файлы (`.py`)
- JavaScript/TypeScript файлы (`.js`, `.ts`)
- Конфигурационные файлы модулей
- Тесты (в подпапках `tests/` внутри модулей)

### Конфигурация
- `Dockerfile` — Docker образ
- `docker-compose.yml` — многоконтейнерная конфигурация
- `.dockerignore` — исключения для Docker

### Зависимости
- `requirements.txt` (Python) — в корне проекта
- `package.json` (Node.js) — в корне проекта
- `pyproject.toml` (Python modern) — в корне проекта

## Что НЕ хранится

- **Виртуальное окружение** `.venv/` — создается в корне проекта, не в `03_src/`
- **Входные/выходные данные** — хранятся в `04_data/`
- **Логи** — хранятся в `05_logs/`
- **Документация проекта** — в `00_docs/`
- **Постановки задач** — в `02_tasks/`

## Правила организации

### 1. Каждый модуль имеет README.md
**Обязательное содержимое:**
- Назначение модуля
- Зависимости (внутренние и внешние)
- Примеры использования
- API (если модуль экспортирует функции/классы)

### 2. Нумерация отражает порядок
- Меньший номер = раньше в логике запуска
- Например: `001_cli` вызывает → `002_core` → `003_data_processing`

### 3. Модули независимы (когда возможно)
- Модуль не должен знать о модулях с бОльшими номерами
- Например: `002_core` НЕ должен импортировать из `003_data_processing`
- Разрешены обратные зависимости: `003_` может импортировать `002_`

### 4. Общие утилиты — в отдельный модуль
- Создать модуль типа `999_utils/` или `000_common/`
- Размещать там функции, используемые несколькими модулями

## Примеры структуры модулей

### CLI модуль (001_cli/)
```
001_cli/
├── __init__.py
├── main.py              # Точка входа
├── commands.py          # CLI команды
├── config.py            # Конфигурация CLI
└── README.md
```

### Бизнес-логика (002_core/)
```
002_core/
├── __init__.py
├── processor.py         # Основная логика
├── models.py            # Модели данных
├── validators.py        # Валидация
└── README.md
```

### API клиент (003_api_client/)
```
003_api_client/
├── __init__.py
├── client.py            # REST клиент
├── auth.py              # Аутентификация
├── models.py            # Модели запросов/ответов
└── README.md
```

## Конвенции кода

### Python
- Стиль: PEP 8
- Форматирование: Black / autopep8
- Линтер: pylint / flake8
- Типизация: Type hints (опционально, но рекомендуется)

### JavaScript/TypeScript
- Стиль: ESLint config
- Форматирование: Prettier
- Типизация: TypeScript (если применимо)

### Комментарии
- Docstrings для функций и классов
- Комментарии для сложной логики
- НЕ комментировать очевидный код

## Тестирование (опционально)

### Структура тестов
```
002_core/
├── __init__.py
├── processor.py
├── tests/
│   ├── __init__.py
│   ├── test_processor.py
│   └── fixtures/
└── README.md
```

### Запуск тестов
```bash
# Python
pytest 03_src/002_core/tests/

# Node.js
npm test
```

## Docker

### Dockerfile
- Размещается в корне проекта или в `03_src/`
- Многоступенчатая сборка (multi-stage) для оптимизации
- Документирование переменных окружения

### docker-compose.yml
- Для локальной разработки
- Описание всех сервисов и зависимостей
- Volumes для данных и логов

## Примеры запуска

### Python проект
```bash
# Из корня проекта
python 03_src/001_cli/main.py [аргументы]

# С модулем
python -m 03_src.001_cli.main [аргументы]
```

### Docker
```bash
# Сборка
docker build -t project_name .

# Запуск
docker run project_name [аргументы]

# Compose
docker-compose up
```

## Важно

1. **Виртуальное окружение в корне проекта**
   ```bash
   # Создание
   python -m venv .venv

   # Активация
   source .venv/bin/activate  # Linux/Mac
   .venv\Scripts\activate     # Windows
   ```

2. **Зависимости фиксируются**
   - После установки новых пакетов обновить `requirements.txt`
   - `pip freeze > requirements.txt`

3. **Секреты НЕ в коде**
   - Использовать `.env` файлы
   - Читать через `python-dotenv` или аналоги
   - `.env` в `.gitignore`
