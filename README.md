# AI Agent Development Template

Система для организации разработки с использованием AI-агентов в разных ролях.

## Быстрый старт

### 1. Первый запуск - Architect

Начните с агента Architect для обсуждения архитектуры:

```
Ты — агент Architect (см. .agents/roles/architect.md).

Прочитай:
- .agents/roles/architect.md
- AGENTS.md
- Все файлы из 00_docs/standards/common/
- Все файлы из 00_docs/standards/architect/

Задача: Обсуди со мной архитектуру проекта и создай детальное описание.

После обсуждения создай overview.md и backlog.md
```

### 2. Создание задачи

После того как Architect создаст архитектуру, попросите создать первую задачу:

```
Создай задачу [описание задачи]
```

Architect создаст `task_brief_01.md` и даст промпт для Analyst.

### 3. Передача между агентами

**Ключевой принцип: Агенты не общаются напрямую. Вы - посредник.**

Каждый агент в конце работы генерирует промпт для следующего агента. Ваши действия:

1. **Скопируйте промпт** который агент положил в чат
2. **Вставьте в новое сообщение** (или новую сессию если контекст заполнен)
3. **Запустите следующего агента**

## Роли агентов

### Architect (Архитектор)
**Когда запускать:**
- Обсуждение архитектуры проекта
- Создание новых задач
- Принятие архитектурных решений (ADR)
- Приемка выполненных задач

**Что делает:**
- Создает `00_docs/architecture/overview.md`
- Ведет `00_docs/backlog.md`
- Создает `task_brief_01.md` для задач
- Создает ADR при архитектурных решениях
- Принимает выполненную работу

**Файлы:** `.agents/roles/architect.md`

### Analyst (Аналитик)
**Когда запускать:**
- После получения промпта от Architect (новая задача)
- После получения промпта от Reviewer (исправления)

**Что делает:**
- Создает детальное техническое задание `analysis_NN.md`
- Описывает КАК реализовать (компоненты, структуры, алгоритмы)
- Эскалирует архитектурные вопросы к Architect

**Файлы:** `.agents/roles/analyst.md`

### Developer (Разработчик)
**Когда запускать:**
- После получения промпта от Analyst (есть техническое задание)

**Что делает:**
- Пишет код в `02_src/`
- Создает отчет о реализации `implementation_NN.md`
- Эскалирует проблемы к Analyst или Architect

**Файлы:** `.agents/roles/developer.md`

### Reviewer (Ревьюер)
**Когда запускать:**
- После получения промпта от Developer (код готов)

**Что делает:**
- Проверяет соответствие коду ТЗ и стандартам
- Создает отчет о проверке `review_NN.md`
- Решает: принять, вернуть Analyst, или эскалировать к Architect

**Файлы:** `.agents/roles/reviewer.md`

## Типичный workflow задачи

```
1. Вы → Architect: "Создай задачу [описание]"
   Architect создает task_brief_01.md
   Architect выдает промпт для Analyst
   
2. Вы копируете промпт → Analyst
   Analyst создает analysis_01.md
   Analyst выдает промпт для Developer
   
3. Вы копируете промпт → Developer
   Developer пишет код + implementation_01.md
   Developer выдает промпт для Reviewer
   
4. Вы копируете промпт → Reviewer
   Reviewer проверяет код + review_01.md
   
   Варианты:
   
   А) Все ок → Reviewer выдает промпт для Architect (приемка)
      Вы → Architect принимает работу, обновляет backlog
      
   Б) Проблемы реализации → Reviewer выдает промпт для Analyst
      Вы → Analyst создает analysis_02.md
      Вы → Developer исправляет + implementation_02.md
      Вы → Reviewer проверяет + review_02.md
      ... (итерации пока не будет ок)
      
   В) Архитектурные проблемы → Reviewer выдает промпт для Architect
      Вы → Architect решает проблему + ADR
      Вы → Analyst обновляет plan + analysis_02.md
      Вы → Developer реализует + implementation_02.md
      ...
```

## Эскалация проблем

### Когда агент эскалирует

Иногда агент не может продолжить работу без решения вопроса:

**Analyst → Architect** (архитектурные вопросы):
- Analyst создает `01_tasks/NNN/_questions_architect.md`
- Analyst генерирует промпт для Architect
- Вы копируете → Architect отвечает + создает ADR
- Architect генерирует промпт для возврата Analyst
- Вы копируете → Analyst продолжает работу

**Developer → Analyst** (проблемы с ТЗ):
- Developer создает `01_tasks/NNN/_questions_analyst.md`
- Developer генерирует промпт для Analyst
- Вы копируете → Analyst отвечает + обновляет analysis
- Analyst генерирует промпт для возврата Developer
- Вы копируете → Developer продолжает работу

**Developer → Architect** (критическая архитектура):
- Аналогично, но через Architect

## Смена агента в той же роли

Если контекст агента заполнился и он начинает "тупить":

1. В текущей сессии агента напишите: `/project:handoff-role`
2. Агент создаст файл передачи дел (например `_analyst_handoff.md`)
3. Агент сгенерирует промпт для преемника
4. Скопируйте промпт и запустите в **новой сессии**

## Параллельная работа (Worktree)

Для параллельной работы над независимыми задачами используйте git worktree:

```
# Architect создает worktree
Создай worktree experiment на ветке experiment
```

Worktree создает отдельную рабочую директорию (например `.worktrees/experiment/` на ветке `experiment`). В ней работа идет как обычно: Analyst → Developer → Reviewer.

**Когда использовать:**
- Параллельная работа (одна задача на review, начинаем другую)
- Проверка гипотез (тестирование разных подходов)
- Срочные правки (hotfix пока feature в разработке)

**После завершения:** Architect мержит ветку в main и удаляет worktree.

**Подробности:** `.claude/skills/worktree/SKILL.md`

## Структура файлов проекта

```
.agents/roles/          # Описания ролей агентов
├── architect.md
├── analyst.md
├── developer.md
└── reviewer.md

.claude/
├── commands/           # Слеш-команды
│   └── handoff-role.md
└── skills/            # Skills для агентов
    ├── handoff/
    ├── project-review/
    └── worktree/

.worktrees/            # Git worktrees (параллельная работа с ветками)
└── branch-name/       # Worktree на ветке branch-name

00_docs/
├── architecture/      # Архитектурные документы
│   ├── overview.md    # Общая архитектура
│   └── decision_NNN_название.md  # ADR (архитектурные решения)
├── standards/         # Стандарты (читают агенты)
│   ├── common/       # Для всех ролей
│   ├── architect/    # Для Architect
│   ├── analyst/      # Для Analyst
│   ├── developer/    # Для Developer
│   └── reviewer/     # Для Reviewer
└── backlog.md        # Реестр задач

01_tasks/             # Задачи
└── NNN_название/     # Папка задачи (NNN = 001, 002...)
    ├── task_brief_01.md         # Постановка от Architect
    ├── analysis_01.md           # Техническое задание от Analyst
    ├── implementation_01.md     # Отчет Developer
    ├── review_01.md            # Отчет Reviewer
    ├── analysis_02.md          # При итерации
    ├── implementation_02.md    # При итерации
    ├── review_02.md           # При итерации
    └── _questions_architect.md # Вопросы для эскалации (опционально)

02_src/               # Исходный код

03_data/              # Данные - исходные и результаты работы алгоритмов
└── NN_название/      # Папки нумеруются по конвенции проекта

04_logs/              # Логи работы алгоритмов для отладки и мониторинга

AGENTS.md             # Специфика проекта для агентов
README.md             # Этот файл (для людей)
```

## Правила нумерации файлов

**Все файлы задачи используют единую нумерацию:**
- Первая версия: `_01` (task_brief_01, analysis_01, implementation_01, review_01)
- При итерации: `_02`, `_03` и т.д.
- `implementation_NN` и `review_NN` всегда имеют одинаковый NN

**Служебные файлы** начинаются с `_`:
- `_questions_architect.md` - вопросы для эскалации
- `_analyst_handoff.md` - передача дел между аналитиками
- Эти файлы можно удалять после завершения работы

## Примеры команд

### Начать новый проект
```
Ты — агент Architect (см. .agents/roles/architect.md).

Прочитай:
- .agents/roles/architect.md
- AGENTS.md
- Все файлы из 00_docs/standards/common/
- Все файлы из 00_docs/standards/architect/

Задача: Обсуди со мной проект [название] и создай архитектуру.
```

### Создать задачу
```
Создай задачу: [описание что нужно сделать]
```

### Принять архитектурное решение
```
Мне нужно решить: [архитектурный вопрос]
```

### Посмотреть статус задач
```
Покажи статус задач из backlog
```

## Принципы работы

### 1. Достаточность + Лаконичность
Все документы должны быть:
- **Достаточными** для понимания
- **Лаконичными** - без воды, дублей, разжевывания

### 2. Конкретика
- Не "релевантные файлы", а конкретные пути
- Не "может быть проблема", а конкретная проблема с файлом:строкой
- Не "общие советы", а специфика ЭТОЙ задачи

### 3. Единая нумерация
- Все файлы начинаются с `_01`
- При итерации - инкремент (`_02`, `_03`)
- Синхронная нумерация в рамках одной итерации

### 4. Эскалация
- Агенты эскалируют через файлы `_questions_*.md`
- Вы копируете промпты и передаете между агентами
- Агенты возвращаются к работе после получения ответа

### 5. Итеративность
- Reviewer может вернуть задачу на доработку
- Нумерация инкрементируется при каждой итерации
- История сохраняется через версии файлов

## Часто задаваемые вопросы

**Q: Агенты общаются напрямую?**
A: Нет. Вы копируете промпты и передаете между агентами.

**Q: Как понять кому передавать задачу?**
A: Агент всегда генерирует промпт для следующего агента. Просто копируйте его.

**Q: Что если агент начал "тупить"?**
A: Используйте `/project:handoff-role` для смены агента в той же роли.

**Q: Нужно ли создавать тесты?**
A: Только если вы явно попросите. По умолчанию Developer не создает тесты.

**Q: Можно ли пропустить Analyst?**
A: Нет. Architect → Analyst → Developer → Reviewer - обязательная последовательность.

**Q: Что если нужно изменить архитектуру?**
A: Обратитесь к Architect, он создаст/обновит ADR и передаст задачу дальше.

## Дополнительная информация

- Стандарты проекта: `00_docs/standards/`
- Описания ролей: `.agents/roles/`
- Архитектура: `00_docs/architecture/overview.md`
- Backlog: `00_docs/backlog.md`
